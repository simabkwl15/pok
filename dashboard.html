<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Dashboard</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f4f6f9; padding: 20px; }
    .toolbar { display: flex; justify-content: space-between; margin-bottom: 15px; }
    .btn-back { background:#6c757d; color:white; padding:8px 14px; text-decoration:none; border-radius:4px; }
    table { border-collapse: collapse; width:100%; background:white; }
    th, td { border:1px solid #ddd; padding:8px; }
    th { background:#2c7be5; color:white; }
    .loading { font-style: italic; }
  </style>
</head>
<body>

<div class="toolbar">
  <h1>Dashboard</h1>
  <a href="?page=data_pok" class="btn-back">‚Üê Kembali</a>
</div>

<div class="loading" id="loading">Memuat data...</div>

<table id="dataTable" style="display:none;">
  <thead><tr id="tableHeader"></tr></thead>
  <tbody id="tableBody"></tbody>
</table>

<script>
  function loadData() {
    google.script.run
      .withSuccessHandler(renderTable)
      .getDashboardData();
  }

  function renderTable(res) {
    const h = document.getElementById('tableHeader');
    const b = document.getElementById('tableBody');
    h.innerHTML = ''; b.innerHTML = '';

    res.header.forEach(c => {
      const th = document.createElement('th');
      th.textContent = c;
      h.appendChild(th);
    });

    res.data.forEach(r => {
      const tr = document.createElement('tr');
      r.forEach(v => {
        const td = document.createElement('td');
        td.textContent = v ?? '';
        tr.appendChild(td);
      });
      b.appendChild(tr);
    });

    document.getElementById('loading').style.display = 'none';
    document.getElementById('dataTable').style.display = 'table';
  }

  loadData();
  setInterval(loadData, 60000);
</script>

</body>
</html>
